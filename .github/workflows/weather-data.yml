name: Weather Data Collection

# Trigger the workflow on a schedule (daily at 10 AM UTC) and manually (workflow_dispatch)
on:
  schedule:
    - cron: '0 10 * * *'  # Runs every day at 10 AM UTC
  workflow_dispatch:  # Allows manual triggering from GitHub UI

jobs:
  weather-job:
    runs-on: ubuntu-latest  # Use an Ubuntu VM to run the workflow

    steps:
      # Step 1: Checkout the repository
      - name: Checkout code
        uses: actions/checkout@v3

      # Step 2: Set up environment (install dependencies if needed)
      - name: Set up environment
        run: |
          # If your weather.sh script requires any packages, install them here
          sudo apt-get update
          sudo apt-get install -y curl  # Example: Adjust depending on your script needs

      # Step 3: Run the weather.sh script
      - name: Run weather.sh script
        run: |
          chmod +x ./weather.sh  # Ensure the script is executable
          ./weather.sh           # Execute the weather script

      # Step 4: Commit and push new data
      - name: Commit and push new data
        run: |
          git config --global user.name "GitHub Actions"  # Set commit username
          git config --global user.email "github-actions@users.noreply.github.com"  # Set commit email

          # Stage all changes
          git add .

          # Commit the changes
          git commit -m "Update weather data"

          # Push the changes back to the repository
          git push origin main  # Adjust 'main' if your default branch is different
